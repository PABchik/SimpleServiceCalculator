<html>
   <head>
    <style>
         .sticky {
         position: fixed;
         top: 0px;  /* если ноль заменить на число (и в скрипте тоже), то блок будет прилипать до того, как верхний край окна браузера дойдёт до верхнего края элемента. Может быть отрицательным числом. Применим, например, при фиксированном сверху меню */
         z-index: 101;
         }
      </style>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
      <link rel="stylesheet" type="text/css" href="css/styles.css">
   </head>
   <body>
      <div class="container-fluid">
         <!-- <div class="service-box"> -->
         <div id="nav">
            <div class="row" style="">
               <div class="col-sm-2"></div>
               <div class="col-sm-8" style=" margin-top:10px;padding:100px 0 50px;background-color:#b72a20; color: white;">
                  <h1 class="header text-center">Калькулятор стоимости ТО</h1>
               </div>
               <div class="col-sm-2"></div>
            </div>
            <div class="row" style="margin-top:100px;">
               <div class="col"></div>
               <div class="col">
                  <h5 class="text-center">Марка</h5>
                  <select v-on:change="changeBrand($event)" v-model="currentBrandId" class="form-control">
                     <option v-if="currentBrandId == null" disabled>Выберите марку автомобиля</option>
                     <option v-for="brand in brands" v-bind:value="brand" class="font-weight-bold"> {{ brand.name }} </option>
                  </select>
               </div>
               <div class="col">
                  <h5 class="text-center">Модель</h5>
                  <select v-on:change="changeModel($event)" v-model="currentModelId" class="form-control">
                     <option v-if="currentBrandId == null" disabled>Сначала выберите марку автомобиля</option>
                     <option v-else disabled>Выберите модель автомобиля</option>
                     <option v-for="model in models" v-bind:value="model" class="font-weight-bold"> {{ model.name }} </option>
                  </select>
               </div>
               <div class="col">
                  <h5 class="text-center">Двигатель</h5>
                  <select v-model="currentEngineId" class="form-control" v-on:change="findServices()">
                     <option v-if="currentBrandId == null" disabled>Сначала выберите марку и модель вашего автомобиля</option>
                     <option v-if="currentModelId == null && currentBrandId != null" disabled>Сначала выберите модель вашего автомобиля</option>
                     <option v-else disabled>Выберите двигатель вашего автомобиля</option>
                     <option v-for="engine in engines" v-bind:value="engine" class="font-weight-bold"> {{ engine.name }} </option>
                  </select>
               </div>
               <div class="col"></div>
               <!-- <div class="col"></div> -->
            </div>
            <div class="row" style="margin-top:50px">
               <div class="col-sm-2"></div>
               <div class="col-sm-2">
                  <img v-if="currentBrandImgSrc != null" v-bind:src="currentBrandImgSrc" class="img-fluid">
                  <div v-else style="background-color: #b72a20; color:white;">
                     <p class="font-weight-bold text-center" style="padding:15px;">Brand is not selected</p>
                  </div>
               </div>
               <div class="col-sm-3">
                  <h5 style="margin-top:15px;"><span class="font-weight-normal" style="margin-right:10px;"> Марка: </span>
                     <span v-if="currentBrandName != null" > {{ currentBrandName }} </span>
                     <span v-else> не выбрано </span>
                  </h5>
                  <h5><span class="font-weight-normal" style="margin-right:10px;"> Модель: </span>
                     <span v-if="currentModelName != null" > {{ currentModelName }} </span>
                     <span v-else> не выбрано </span>
                  </h5>
                  <h5><span class="font-weight-normal" style="margin-right:10px;"> Двигатель: </span>
                     <span v-if="currentEngineName != null" > {{ currentEngineName }} </span>
                     <span v-else> не выбрано </span>
                  </h5>
               </div>
               <!-- <div class="col-sm-1"></div> -->
               <!-- <div class="col"></div> -->
               <div class="col-sm-2">
                  <img v-if="currentModelImgSrc != null" v-bind:src="currentModelImgSrc" class="img-fluid" style="margin-bottom: 15px;">
                  <div v-else style="background-color: #b72a20; color:white;">
                     <p class="font-weight-bold text-center" style="padding:15px;">Model is not selected</p>
                  </div>
               </div>
               <div class="col-sm-2"></div>
            </div>
            <!-- <p>{{ currentBrandId }}</p>
               <p>{{ brands }}</p>
               
               <p>{{ currentModelId }} </p>
               
               <p>current engine-{{ currentEngineId }} </p> -->
         </div>
         <div id="expenses">
          <div class="row">
            <div class="col-sm-7"></div>
            <div class="col-sm-3 border-box" id="aside1">
                  <!-- {{currentBrandImgSrc}} -->
                  <p class="font-weight-bold">стоимость работ: <br>{{ work }}  &#x20bd;</p>
                  <p class="font-weight-bold">стоимость запчастей: <br>{{ parts }}  &#x20bd;</p>
                  <!-- <p class="font-weight-bold lead">___________________</p> -->
                  <p class="font-weight-bold lead" style="border-top:2px solid #b72a20;">Итого: {{ work + parts }}  &#x20bd;</p>
            </div>
            <div class="col-sm-2"></div>
          </div>
         </div>
         <!-- </div> -->
         <div id="services" style="margin-top:50px">
            <!-- <p>{{ services }}</p> -->
            <div>
               <div v-for="s in services">
                  <div class="row">
                     <div class="col-sm-2"></div>
                     <div class="col-sm-5 service-box">
                        <h5><label><input type="checkbox"  v-bind:id="s.id" v-bind:value="s" v-model="checkedService" v-on:change="checkChanges(s.id)">
                           <span class="service-name" style="border-bottom:1px dashed grey">{{ s.name }}</span>   {{ "     " + s.price }}&#x20bd;</label>
                           <small class="text-muted"><br>{{s.description}}</small>
                        </h5>
                        <div>
                           <div v-for="type in partTypesForService">
                              <!-- <p>{{ type.service_for_car_id == s.id }} </p> -->
                              <!-- <div class="row"> -->
                              <!-- <div class="col"></div> -->
                              <div>
                                 <div v-if="type.service_for_car_id == s.id && checkedService.indexOf(s) != -1">
                                    <h6><label><input type="checkbox" v-bind:value="type" v-model="checkedPartTypes" v-bind:id="type" v-on:click="checkChanges(s.id, type.part_type_id)">
                                       {{ type.name }}</label>
                                    </h6>
                                    <div>
                                       <div v-for="part in partsForCar">
                                          <!-- <p>{{part.name}}  {{part}}</p> -->
                                          <div class="row">
                                             <div class="col-sm-1"></div>
                                             <div class="col-sm-11">
                                                <div v-if="part.part_type_id == type.id && part.service_for_car_id == s.id && checkedPartTypes.indexOf(type) != -1">
                                                   <label><input type="radio" v-bind:name="part.part_type_id" v-bind:value="part" v-on:click="addPart(part)" >{{part.name}}	{{ part.price * part.count}} &#x20bd;</label>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <!-- <p>{{ partTypesForService }}</p> -->
                           </div>
                        </div>
                     </div>
                     <div class="col-sm-5"></div>
                  </div>
               </div>
               <div class="row">
                  <div class="col-sm-2"></div>
                  <div class="col-sm-5 service-box">
                     <label>Пожалуйста, укажите VIN номер вашего автомобиля, чтобы наши сотрудники могли еще раз все перепроверить</label>
                     <input type="text" placeholder="Введите ваш VIN">
                     <label>Пожалуйста, укажите дополнительные пожелания и мы постараемся их исполнить</label>
                     <textarea name="comments" class="form-control" placeholder="Дополнительные комментарии"></textarea>
                  </div>
                  <div class="col-sm-5"></div>
               </div>
               <!--
                  <div class="row" v-if="services != null">
                  	<div class="col-sm-2"></div>
                  	<div class="col-sm-5 service-box">
                  		<label>Пожалуйста, укажите VIN номер вашего автомобиля, чтобы наши сотрудники могли еще раз все перепроверить</label>
                  		<input type="text" max-lenght="1" name="vin" class="form-control">
                  	</div>
                  	<div class="col-sm-5"></div>
                  </div>
                  <div class="row" v-if="services != null">
                  	<div class="col-sm-2"></div>
                  	<div class="col-sm-5 service-box">
                  		<label>Пожалуйста, укажите номер телефона, чтобы мы могли перезвонить вам и договориться о вашем визите</label>
                  		<input type="text" name="phone" class="form-control">
                  	</div>
                  	<div class="col-sm-5"></div>
                  </div>
                  </div>
                  <p>{{ checkedService }}</p>
                  <p>{{ checkedPartTypes }}</p>
                  <!- p>{{services}}</p>
                  <p>{{partTypesForService}}</p>
                  <p>{{ partsForCar }} </p> -->
               <!-- <p>{{checkedParts}}</p> -->
            </div>
            <!-- <div style="height: 1000px; background-color:red">
               </div> -->
         </div>
         <!-- <div id="brandModelSettings">
            <select>
            	<option v-for="logo in logos">{{ logo.img_src }}</option>
            </select>
            <p> {{ logos }} </p>
            <select>	
            	<option v-for="logo in logos">{{ logo.img_src }}</option>
            	
            </select>
            <p>{{ v }}</p>
            </div> -->
      </div>
      <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
      <script src="js/app.js"></script>
      
      <script>
         (function(){  // анонимная функция (function(){ })(), чтобы переменные "a" и "b" не стали глобальными
         var a = document.querySelector('#aside1'), b = null;  // селектор блока, который нужно закрепить
         window.addEventListener('scroll', Ascroll, false);
         document.body.addEventListener('scroll', Ascroll, false);  // если у html и body высота равна 100%
         function Ascroll() {
           if (b == null) {  // добавить потомка-обёртку, чтобы убрать зависимость с соседями
             var Sa = getComputedStyle(a, ''), s = '';
             for (var i = 0; i < Sa.length; i++) {  // перечислить стили CSS, которые нужно скопировать с родителя
               if (Sa[i].indexOf('overflow') == 0 || Sa[i].indexOf('padding') == 0 || Sa[i].indexOf('border') == 0 || Sa[i].indexOf('outline') == 0 || Sa[i].indexOf('box-shadow') == 0 || Sa[i].indexOf('background') == 0) {
                 s += Sa[i] + ': ' +Sa.getPropertyValue(Sa[i]) + '; '
               }
             }
             b = document.createElement('div');  // создать потомка
             b.style.cssText = s + ' box-sizing: border-box; width: ' + a.offsetWidth + 'px;';
             a.insertBefore(b, a.firstChild);  // поместить потомка в цепляющийся блок первым
             var l = a.childNodes.length;
             for (var i = 1; i < l; i++) {  // переместить во вновь созданного потомка всех остальных потомков (итого: создан потомок-обёртка, внутри которого по прежнему работают скрипты)
               b.appendChild(a.childNodes[1]);
             }
             a.style.height = b.getBoundingClientRect().height + 'px';  // если под скользящим элементом есть другие блоки, можно своё значение
             a.style.padding = '0';
             a.style.border = '0';  // если элементу присвоен padding или border
           }
           if (a.getBoundingClientRect().top <= 0) { // elem.getBoundingClientRect() возвращает в px координаты элемента относительно верхнего левого угла области просмотра окна браузера
             b.className = 'sticky';
           } else {
             b.className = '';
           }
           window.addEventListener('resize', function() {
             a.children[0].style.width = getComputedStyle(a, '').width
           }, false);  // если изменить размер окна браузера, измениться ширина элемента
         }
         })()
      </script>
   </body>
</html>